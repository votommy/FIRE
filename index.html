<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Tommy Vo | Software Developer</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <link rel="stylesheet" href="fire.css">
        <link rel="stylesheet" href="bubbles.css">
    </head>
    <body>
        <main>
            <ul class="bubbles">
                <li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li>
            </ul>
            
            <article>
                <div class="container">
                    <section><span class="anchor" id="aboutMe"></span>
                        <div class="blurBox">
                            <span class="h1">See when you can retire given your lifestyle.</span>
                            <br><br>
                            <span>Monthly Spending in Retirement: </span><span id="labelFront">$</span><input id="spending" placeholder="0.00" type="number" min="0"><br><br>
                            <span>Current Investment: </span><span id="labelFront">$</span><input id="investment" placeholder="0.00" type="number" min="0"><br><br>
                            <span>Annual Contribution: </span><span id="labelFront">$</span><input id="annualContribution" placeholder="0.00" type="number" min="0"><br><br>
                            <span>Return Rate: </span><span id="labelFront">%</span><input id="returnRate" placeholder="0.0" type="number" min="0"><br><br>
                            <span>Current Age: </span><span id="label"></span><input id="age" placeholder="0" type="number"><span id="labelEnd" min="0">years</span><br><br>
                            <button onclick="calculate()">Calculate</button>
                            <hr>
                            <span id="outputTable"></span>
                        </div>
                    </section>
                </div>
            </article>
        </main>
        
        <script>
            let retirementMarker = 1;
            
            function calculate() {
                const getSpending = document.getElementById("spending");
                const getInvestment = document.getElementById("investment");
                const getAnnualContribution = document.getElementById("annualContribution");
                const getReturnRate = document.getElementById("returnRate");
                const retirementGoal = (getSpending.value / (getReturnRate.value / 100)) * 12;
                const getAge = document.getElementById("age");
                
                let spending = getSpending.value;
                if (spending.length == 0) {
                    spending = 0.0;
                }
                let investment = getInvestment.value;
                if (investment.length == 0) {
                    investment = 0.0;
                }
                let annualContribution = getAnnualContribution.value;
                if (annualContribution.length == 0) {
                    annualContribution = 0.0;
                }
                const returnRate = (getReturnRate.value / 100) + 1;
                let age = getAge.value;
                if (age.length == 0) {
                    age = 0;
                }
                
                let year = new Date().getFullYear();
                let count = 0;
                let xtraDigit = "0";
                retirementMarker = 1;
                let retireYet = 0;
                let endAge = 65;
                let previousInvestment = 0;
                let gains = 0;
                
                const outputTable = document.getElementById("outputTable");
                var text = "<table><tr><th>#</th><th>Age</th><th>Year</th><th>Wealth</th><th>Gains</th></tr>";

                while (age <= endAge) {
                    previousInvestment = investment;
                    if (count > 9) {
                        xtraDigit = "";
                    }
                    if (investment >= retirementGoal && retireYet == 0) {
                        retirementMarker = count;
                        retireYet = 1;
                        if (age > (endAge - 10)) { // Always show at LEAST 10 years after retirement
                            endAge = age + 10;
                        }
                    }                                        
                    let labelCol = "<tr><td>" + xtraDigit.concat(count) + "</td><td>" + age + " years old</td><td>" + year + "</td><td>" + new Intl.NumberFormat('en-US', {style: 'currency', currency: 'USD'}).format(investment) + "</td><td>" + new Intl.NumberFormat('en-US', {style: 'currency', currency: 'USD'}).format(gains) + "</td></tr>"
                    text += labelCol;                    
                    investment *= returnRate;
                    investment = parseFloat(investment) + parseFloat(annualContribution);
                    gains = investment - previousInvestment;
                    age++;
                    year++;
                    count++;
                }
                text += "</table>";
                outputTable.innerHTML = text;
                highlightRetirement();
            }            
            
            $(document).ready(function() { //jQuery
                $(function() { 
                    function jsFunc(){ 
                        $("tr:nth-child(" + retirementMarker + ")").css("color", "var(--tommagenta)");
                        $("tr:nth-child(" + retirementMarker + ")").css("font-weight", "bold");
                    }  
                    highlightRetirement = jsFunc;
                }) 
            }); //End jQuery
            
        </script>
    </body>
</html>